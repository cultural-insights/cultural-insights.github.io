If you think the stock market's steep slide this month hammered your personal portfolio or 401(k), imagine what it's done to California's state pension system, CalPERS. Years of overoptimistic stock purchases and inadequate contributions have left it terribly vulnerable, and just a few years of down markets could leave it insolvent.

Financial statements released last month (for the fiscal year ending June 30, 2015) showed that the pension system was only 77% funded — and that percentage has certainly dropped alongside all the stock indices in recent weeks. If taxpayers are going to avoid having to bail out CalPERS, the system needs an overhaul.

Even before the recent market downturn, CalPERS was struggling.

Two state laws are to blame for the system's financial struggles. Proposition 21, passed in 1984, allowed CalPERS fund managers to move its investments from safe and predictable bonds to risky and volatile stocks and hedge funds to try to generate a higher return. SB 400, passed in 1999, increased pension payouts by 50% for California Highway Patrol employees, a move quickly replicated at other state agencies and local governments.

In the midst of a bull market such as the late '90s tech bubble, perhaps that seemed fine. But it was irresponsible. At the top of a market cycle, a healthy pension system should be overfunded — and then should hold onto the excess to ride out bear markets. CalPERS didn't do that, and so market corrections suddenly become an existential threat.

CalPERS actuaries rely on earning a 7.5% annual return on investment to meet the current and future pension obligations to 1.8 million participants. But current stock market conditions make achieving that goal much harder — if not impossible — over the next several years. And that will leave taxpayers on the hook for billions.

How much taxpayers contribute to the pension fund each year is determined by two factors: how much CalPERS owes in current and future benefits, and how much it expects to earn on its investments. If expected earnings are high, the hundreds of public agencies and school districts contribute less money up front. But later, when those mythical 7.5% returns don't materialize, taxpayers are left to make up the shortfall.

Even before the recent market downturn, CalPERS was struggling. In the fiscal year that ended June 30, the fund earned a net return of only 2.4% on its $301.1 billion of invested assets. If CalPERS had earned its target 7.5%, it would have made $22.6 billion; instead it made only $6.6 billion. To make up that lost ground this fiscal year, it would have to earn 12.8% — hardly realistic in this volatile market.

In November, the CalPERS board of governors finally voted to lower the fund's projected rate of return — but only to 6.5% per year. And even that modest cut is being implemented incrementally so that it won't fully take effect for 20 years. Meanwhile, new market realities may make even a 6.5% rate of return too optimistic.

Exacerbating the funding problem is the fact that CalPERS retirees are living longer, and more and more of them are post-1999 retirees collecting those 50% bigger pensions. For the last three years, CalPERS' has paid out about $5 billion more in pension disbursements than it has collected in contributions.

There just aren't enough workers, and they aren't contributing a fair amount to their pension plan, for this to be sustainable. Currently, there are 1.3 working participants for each retiree drawing money out. Just a decade ago, that ratio was 2 to 1. Meanwhile, the employees' share of contributions to CalPERS has actually declined by almost 5% in recent years, while the taxpayers' share has risen by more than 24%.

The solution for what ails CalPERS is simple, but getting it done will prove politically challenging. CalPERS can start by supporting policies that reverse the effects of Proposition 21 and SB 400. CalPERS was instrumental to getting both passed; now it needs to reform them to restore financial health to the system. For example, if CalPERS lowered the rate at which active workers accrue pension benefits going forward — not even retroactively — that would go a long way.

CalPERS also needs higher contribution rates from employees. Today the state (read: taxpayers) pays in about $3 for every $1 in employee contributions. A private sector employer offering a generous contribution to a 401(k) plan usually has a 1-to-1 ratio.

Taking these steps immediately can avoid more painful solutions later, and keep the public pension system viable. Unless the country slides into another prolonged recession. Then all bets are off.

Ed Ring is the executive director at the California Policy Center.

Follow the Opinion section on Twitter @latimesopinion and Facebook