President Obama wanted last week's headlines to focus on a U.S. diplomatic triumph, his opening of a new relationship with Cuba. But his upbeat moment in Havana was eclipsed by terrorist bombs in Brussels and fears of more attacks to come. That turn of events captured, in an instant, Obama's foreign policy record: success in diplomacy, frustration at war.

Obama has notched up some genuine achievements with his diplomatic strategy of engagement: the opening to Cuba, a nuclear agreement with Iran and a stronger alliance with Vietnam and other countries in Southeast Asia.

He's been strikingly less effective, however, at combining diplomacy with force to stabilize parts of the world where the players aren't as interested in peaceful engagement — mainly the battle zones of the Middle East.

Seven years into his presidency, he's still reacting against the errors of his predecessor, George W. Bush. “What I think is not smart is the idea that every time there is a problem, we send in our military to impose order,” he told Jeffrey Goldberg of the Atlantic in a recent interview.

He's right, of course; that wouldn't be smart. But it's also a straw man. Even Sen. John McCain, Washington's most enthusiastic interventionist, doesn't advocate troops “every time there is a problem.”

And Obama's resistance to intervention has come at a cost. Not only the usual critics, but also some veterans of his administration argue that his hasty withdrawal from Iraq and his refusal to support the armed opposition in Syria gave Islamic State the room it needed to grow before the White House noticed it in 2014.

“Obama feared a slippery slope in going up against Bashar Assad in Syria, but the war against [Islamic State] is the slipperiest slope of them all,” former State Department official Tamara Wittes wrote recently. “The lesson is that inaction is not obviously better than action.... It is a choice, and it carries consequences.”

Although Obama wants people to remember the new relationships he's opened, like those with Cuba and Iran, his legacy will inescapably include Iraq and Syria too.

After Islamic State fighters swept across northern Iraq in 2014 and threatened to conquer Baghdad, Obama launched airstrikes against the group and sent a small group of U.S. military advisors to shore up Iraqi forces. The advisors have grown to almost 5,000 in Iraq, plus about 50 special operations troops on the ground in neighboring Syria, where Islamic State's headquarters lie.

Their missions have been designed to help, rather than supplant, local forces; Obama wants to avoid making U.S. troops responsible for ground combat again.

So progress has been slow. When the U.S. operation began, commanders said they estimated it would take roughly five years to defeat Islamic State, from 2014 to 2019. That was intended to provide time to train local forces on the ground.

When Islamic State's operations were confined to Syria and Iraq, that sounded like a tolerable timetable, if a long one. Now that the group has spread to other countries and expanded its war into Europe with devastating effect, a five-year timeline seems less reasonable.

So if there's an Obama Doctrine, at least in the Middle East, it goes something like this: Keep U.S. military commitments limited — but be ready for disappointment when limited action produces modest results.

Obama sometimes sounds as if he'd like to focus Americans' attention away from the enemies he's been unable to check.

“[Islamic State] is not an existential threat to the United States,” he told Goldberg. “Climate change is a potential existential threat to the entire world.”

He'd rather be working on diplomacy in more promising parts of the world, talking with young entrepreneurs in Asia and Africa and Latin America.

“If we're not talking to them,” he said, “because the only thing we're doing is figuring out how to destroy or cordon off or control the malicious, nihilistic, violent parts of humanity, then we're missing the boat.” That's true. But a president can't pick and choose what urgent problems come his way.

Although Obama wants people to remember the new relationships he's opened, like those with Cuba and Iran, his legacy will inescapably include Iraq and Syria too.

He came to office determined to put diplomacy at the center of U.S. foreign policy and reduce our reliance on military force — and he's done that.

But he hasn't solved the toughest riddle: what to do about the world's most dangerous places, the failed states of the Middle East. That problem remains for his successor to tackle.

The president will spend the rest of the year arguing that his policies have worked, or at least that the alternatives were worse. For now, the grade he deserves is one of incomplete.

doyle.mcmanus@latimes.com

Twitter: @doylemcmanus

Follow the Opinion section on Twitter @latimesopinion and Facebook